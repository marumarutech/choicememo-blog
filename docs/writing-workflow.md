# 記事執筆ワークフロー（Codex 併用）

## 目的
- ChoiceMemo の記事執筆を効率化しつつ品質を確保するための手順をまとめる。
- Codex（AI アシスタント）との協業で行うべきステップと、人間側の判断ポイントを明確にする。

## 全体フロー
1. **テーマ決定**: 目的読者・狙い・期待する CTA を整理する。
2. **構成ドラフト作成**: Codex に構成案を依頼し、必要なら想定見出しを先に伝える。
3. **本文ドラフト生成**: セクション単位で Codex に本文案を作成してもらう。事実確認は必ず人間が行う。
4. **検証と追記**: 最新情報・固有データ・リンク・画像パスなどを手元で補足する。
5. **ファイル整備**: `content/posts/*.mdx` に記事を保存し、フロントマター・MDX コンポーネントを適切に設定。
6. **サムネイル準備**: 1200×630 目安で画像を用意し、`public/images/posts/` に配置、`hero` で参照する。
7. **Note 版（簡易版）**: 本編公開後に重要ポイントだけを抜き出し、別ファイルで短尺記事を用意。
8. **レビュー→コミット→PR**: `git add` → `git commit` → `git push`。PR には `.reports/security-summary.md` 等の関連資料があれば添付する。

## Codex への依頼テンプレ
```text
テーマ: npm サプライチェーン攻撃の裏側と対策
読者: フロントエンドエンジニア / チームリーダー
目的: 攻撃の流れと具体的な防御手順を提示し、社内で共有できる記事にする
構成案を5つの見出しで提案してください
```
- 構成が固まったら、各セクションごとに「この流れで本文を 400 文字程度で」「手順は箇条書きで」など条件を明示。
- 出力されたドラフトは **必ずファクトチェック** し、数値・日付・引用元の裏付けを取る。
- Codex に再要約を依頼して Note 版の原稿を作ると作業が短縮できる。

## ファイル作成ルール
- 置き場所: `content/posts/<slug>.mdx`
- 文字コード: UTF-8（BOM なし）
- ファイル名: 英小文字＋ハイフン。例 `npm-supply-chain-attack-2025.mdx`
- フロントマター例:
  ```mdx
  ---
  title: "npmサプライチェーン攻撃の裏側と防御ガイド"
  slug: "npm-supply-chain-attack-2025"
  description: "2025年9月に起きた攻撃の流れと再発防止策を9ステップで整理。"
  category: "topics"        # カテゴリは docs/content-authoring.md を参照
  tags: ["セキュリティ", "npm", "サプライチェーン"]
  date: "2025-09-17"
  updated: "2025-09-17"
  hero: "/images/posts/npm-supply-chain-2025.png"
  affiliate: false
  draft: on                # on=public / off=hidden
  ---
  ```
- サムネイル: `public/images/posts/` に配置し、ファイル名は記事スラッグ由来で統一。
- Note 版は `*-note.mdx` の命名で本編と並べて配置。

## チェックリスト
- [ ] ファクトチェック済み（リンク / 数値）
- [ ] フロントマター項目を埋めた（`hero` 含む）
- [ ] 画像ファイルを `public/images/posts/` に追加
- [ ] MDX コンポーネント（Lead, ProsCons など）が正しく閉じている
- [ ] ローカルで `npm run dev` プレビュー
- [ ] 必要に応じて `.reports/` や関連資料へのリンクを記事末尾に追加
- [ ] `git status` がクリーンになるまでコミット＆プッシュ

## 運用メモ
- Codex とのやり取りはタスクごとに記録しておくと再利用しやすい。例: `docs/task/2025-09-security-article.md` に議事録を残す。
- 執筆プロセスで追加したスクリプトや画像は、PR の説明に含めてレビュアーにも共有する。
- ノウハウが溜まったら、本ドキュメントを更新して最新のベストプラクティスを反映する。
